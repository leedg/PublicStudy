#pragma once

#include <cstdint>
#include <vector>
#include <memory>

namespace Network::Interfaces {

// Type definitions
using ConnectionId = uint64_t;

/**
 * Message type enumeration
 */
enum class MessageType : uint32_t {
    Unknown = 0,
    Ping = 1,
    Pong = 2,
    CustomStart = 1000
};

/**
 * Message structure
 */
struct Message {
    MessageType type = MessageType::Unknown;
    ConnectionId connectionId = 0;
    std::vector<uint8_t> data;
    uint64_t timestamp = 0;
};

/**
 * Interface for message handling
 * Each server implementation should inherit and implement this interface
 */
class IMessageHandler {
public:
    virtual ~IMessageHandler() = default;

    /**
     * Process incoming message
     * @param connectionId Source connection ID
     * @param data Raw message data
     * @param size Data size in bytes
     * @return true if message was processed successfully
     */
    virtual bool ProcessMessage(
        ConnectionId connectionId,
        const uint8_t* data,
        size_t size) = 0;

    /**
     * Create outgoing message
     * @param type Message type
     * @param connectionId Target connection ID
     * @param data Payload data
     * @param size Payload size
     * @return Serialized message ready to send
     */
    virtual std::vector<uint8_t> CreateMessage(
        MessageType type,
        ConnectionId connectionId,
        const void* data,
        size_t size) = 0;

    /**
     * Get current timestamp in milliseconds
     * @return Current timestamp
     */
    virtual uint64_t GetCurrentTimestamp() const = 0;

    /**
     * Validate message format
     * @param data Raw message data
     * @param size Data size
     * @return true if message format is valid
     */
    virtual bool ValidateMessage(const uint8_t* data, size_t size) const = 0;
};

} // namespace Network::Interfaces
