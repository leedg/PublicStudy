# ServerEngine 부하테스트 로그 (Ramp-up 1차)

## 1. 실행 정보

- 테스트 일시: `2026-02-27`
- 실행자: `Codex`
- OS: `Windows (PowerShell)`
- 빌드: `x64 Debug (기존 바이너리)`
- 실행 환경: `동일 머신에서 DBServer/TestServer/TestClient 동시 실행`
- 서버 백엔드: `RIO (auto)`
- 측정 성격:
  - `처리량 벤치마크`가 아니라 `동시 접속 유지 가능성` 확인
  - 클라이언트는 `TestClient.exe` 프로세스 단위로 생성
  - 종료는 `강제 정리` 기준

관련 로그:
- `10 clients`
  - `.tmp_run_logs/20260227_111258_s10_server_out.txt`
  - `.tmp_run_logs/20260227_111258_s10_db_out.txt`
- `50 clients`
  - `.tmp_run_logs/20260227_111258_s50_server_out.txt`
  - `.tmp_run_logs/20260227_111258_s50_db_out.txt`
- `100 clients`
  - `.tmp_run_logs/20260227_111258_s100_server_out.txt`
  - `.tmp_run_logs/20260227_111258_s100_db_out.txt`
- `500 clients`
  - `.tmp_run_logs/20260227_111914_s500_server_out.txt`
  - `.tmp_run_logs/20260227_111914_s500_db_out.txt`
- `1000 clients (부분 관측)`
  - `.tmp_run_logs/20260227_112656_s1000_server_out.txt`
  - `.tmp_run_logs/20260227_112656_s1000_db_out.txt`

---

## 2. 결과 요약

| 단계 | 실행 결과 | Launch 시간 | 샘플 시점 생존 클라 | 서버 연결 로그 수 | 서버 오류/경고 | 비고 |
|------|-----------|-------------|----------------------|-------------------|----------------|------|
| 10 | Pass | 0.92s | 10 | 10 | 0 | 정상 |
| 50 | Pass | 8.08s | 50 | 50 | 0 | 정상 |
| 100 | Pass | 22.06s | 100 | 100 | 0 | 정상 |
| 500 | Pass | 151.01s | 500 | 500 | 0 | 정상 |
| 1000 | Partial Fail | 장시간 소요 | N/A | 655 | 4425 | RIO 자원 고갈/재연결 폭주 |

---

## 3. 주요 관측

### 10 / 50 / 100 / 500 단계

- 서버가 `RIO` 백엔드로 정상 기동
- `Client connected - IP:` 로그 수가 목표 수와 일치
- 샘플 시점에서 시작한 클라이언트 수와 생존 프로세스 수가 일치
- `Failed to queue recv`, `[WARN]`, `[ERROR]` 없음

프로세스 지표:

| 단계 | Server Working Set | Server Handles |
|------|--------------------|----------------|
| 10 | 35.1 MB | 172 |
| 50 | 35.9 MB | 216 |
| 100 | 37.0 MB | 267 |
| 500 | 44.9 MB | 662 |

### 1000 단계

`1000` 단계에서는 안정 구간에 진입하지 못하고 `RIO` 자원 부족으로 붕괴함.

집계:
- `Client connected - IP:`: `655`
- `Failed to queue recv - ... RIORecv failed`: `386`
- `Failed to associate socket with async backend - Failed to create RIO request queue (WSA: 10055)`: `4039`
- 총 `[WARN]/[ERROR]`: `4425`
- `Session initialized - ID:`: `5081`

대표 오류:

```text
Failed to associate socket with async backend - Session N:
Failed to create RIO request queue (WSA: 10055)
```

해석:
- `WSA 10055`는 소켓/버퍼 자원 부족 계열로 보는 게 타당
- 새 연결이 실패하면서 클라이언트 재연결이 겹쳐 `Session initialized`가 급증
- 즉, `1000 동접 유지 실패`보다 정확히는 `RIO request queue 생성 한계`와 `재연결 폭주`가 먼저 발생

---

## 4. 판정

- `500 clients`: `Pass`
- `1000 clients`: `Fail (RIO resource limit observed in current setup)`

현재 결론:
- 현재 `x64 Debug + 동일 머신 + RIO(auto)` 조건에서는 `500`까지는 안정적
- `1000`에서는 `RIO request queue` 생성이 `WSA 10055`로 실패하며 안정 유지 불가

---

## 5. 다음 액션

1. `Release + MSBuild 환경`에서 동일 시나리오 재측정
2. `IOCP 강제 모드`로 `500 / 1000` 비교 측정
3. `1000` 이상이 목표면 `RIO request queue/registered buffer/socket 자원 한계` 분석 필요

